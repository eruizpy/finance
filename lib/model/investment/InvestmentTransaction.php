<?php


/**
 * Skeleton subclass for representing a row from the 'investment_transaction' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Sun Feb 20 09:16:00 2011
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model.investment
 */
class InvestmentTransaction extends BaseInvestmentTransaction 
{
  /**
   * Initializes internal state of InvestmentTransaction object.
   * @see        parent::__construct()
   */
  public function __construct(Transaction $transaction = null, Investment $investment = null)
  {
    $this->setTransaction($transaction);
    $this->setInvestment($investment);

    parent::__construct();
  }
  
  /**
   * Post insert
   * 
   * @param PropelPDO $con 
   */
  public function postInsert(PropelPDO $con = null) 
  {
    $investment = $this->getInvestment();

    if($this->getTransaction()->isCredit()){
      
      //set values investment
      $investment->setBalance($investment->getBalance() + $this->getAmount());

    }elseif($this->getTransaction()->isDebit()){
      
      //set values investment
      $investment->setBalance($investment->getBalance() - $this->getAmount());
    }
    
    //update $account
    $investment->save();
    
    $this->getTransaction()->setType(Transaction::TYPE_INVESTMENT);
    
    $this->getTransaction()->save($con);
    
    parent::postInsert($con);
  }
  
  /**
   * Get transaction type in format text
   * 
   * @return string 
   */
  public function getTypeOperationText()
  {
    return $this->getTransaction()->getTypeOperationText();
  }
  
  /**
   * Get isDebit
   * 
   * @return boolean 
   */
  public function isDebit()
  {
    return $this->getTransaction()->isDebit();
  }
  
  /**
   * Get IsCredit
   * 
   * @return boolean 
   */
  public function isCredit()
  {
    return $this->getTransaction()->isCredit();
  }
  
  /**
   * Get transactionType
   * 
   * @return TransactionType 
   */
  public function getTransactionType()
  {
    return $this->getTransaction()->getTransactionType();
  }
  
  /**
   * Get connection
   * 
   * @return Connection 
   */
  public function getConnection()
  {
    return $this->getTransaction()->getCash();
  }
  
  /**
   * Get user
   * 
   * @return sfGuardUser 
   */
  public function getUser()
  {
    return $this->getTransaction()->getUser();
  }
  
  /**
   * Get amount
   * 
   * @return type 
   */
  public function getAmount()
  {
    return $this->getTransaction()->getAmount();
  }
  
  /**
   * Get createdAt
   * 
   * @return dataTime 
   */
  public function getCreatedAt($format = 'Y-m-d H:i:s')
  {
    return $this->getTransaction()->getCreatedAt($format);
  }
  
  /**
   * Get Observation
   * 
   * @return type 
   */
  public function getObservation()
  {
    return $this->getTransaction()->getObservation();
  }
  
} // InvestmentTransaction
