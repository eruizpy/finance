<?php


/**
 * Skeleton subclass for representing a row from the 'account_bankbook' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Thu Feb 17 18:59:47 2011
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model.account
 */
class Bankbook extends BaseBankbook 
{
  /**
   * Initializes internal state of AccountBankbook object.
   * @see        parent::__construct()
   */
  public function __construct()
  {
    // Make sure that parent constructor is always invoked, since that
    // is where any default values for this object are set.
    parent::__construct();
  }
  
  /**
   * Post insert
   * 
   * @param PropelPDO $con 
   */
  public function postInsert(PropelPDO $con = null) 
  {
    $criteria = new Criteria();
    
    $criteria->add(BankbookPeer::ACCOUNT_ID, $this->getAccount()->getId(), Criteria::EQUAL);
    $criteria->add(BankbookPeer::ID, $this->getId(), Criteria::ALT_NOT_EQUAL);
    $criteria->add(BankbookPeer::IS_ACTIVE, TRUE, Criteria::EQUAL);
    
    $bankbooks = BankbookPeer::doSelect($criteria);
    
    foreach ($bankbooks as $bankbook){
      $bankbook->setIsActive(FALSE);
      $bankbook->save();
    }
    
    parent::postInsert($con);
  }

  /**
   * Method toString
   * 
   * @return string 
   */
  public function  __toString() 
  {
    return $this->getNumber();
  }

} // AccountBankbook
